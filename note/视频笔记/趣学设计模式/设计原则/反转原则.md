# 反转原则

依赖反转原则, Dependence Inversion Principle, DIP.

## DIP: 统一代码交互的标砖

DIP原则就是一种统一代码交互标准的软件设计方法

原始定义如下:

- 高级组件不应该依赖于低级组件, 两者都应该依赖抽象
- 抽象不应该依赖实现, 实现应该依赖抽象

如何理解DIP的这个原始定义:

- 首先, 定义中的高级组件和低级组件, 主要对应的是调用关系上的层级
- 其次, 高级组件和低级组件都应依赖抽象, 是为了消除组件间变化对对方造成的影响. 抽象是一种约束, 让高级组件或低级组件不能太随意的变动
- 最后, 抽象不应该依赖实现, 实现应该依赖抽象. 

## 为什么要使用DIP

使用DIP的意义两点:

- 可以有效的控制代码变化的影响范围
- 可以使代码具有更强的可读性和可维护性

当外部系统的需求或者功能变化影响到内部系统, 使用DIP可以控制这种代码带来的影响.

使用DIP, 可以从设计上减少系统的耦合性, 更能帮助厘清逻辑, 因为代码是通过统一抽象之后, 功能相同的处理都在同一个地方, 所以, 代码变得更加顺畅, 更容易让人理解. 

## IoC、DI、IoC 容器与 DIP 的区别

- 控制反转（Inversion of Control，简称 IoC），是一种设计原则（也有人将其称为设计模式）: 它用于反转设计中各种组件的控制关系，以实现松耦合
- 依赖注入（Dependency Injection，简称 DI），是用于实现 IoC 的设计模式。简单来说，它允许在类之外创建依赖对象，并通过不同方式将这些对象提供给类。一般来讲，主要有三种方式来注入类：通过构造函数、通过属性和通过方法。
- IoC 容器（又叫作 DI 容器），是用于实现自动依赖注入的框架。它的作用是管理对象的创建及其生命周期，并提供向类注入依赖项的具体实现，这样做是为了我们不必手动创建和管理对象。但实际上更准确的描述应该是 DI 容器，只不过因为 Spring 号称自己为 IoC 容器而造成了误解。


这四种的关系如下:

- IoC 容器是一种技术框架，它用来管理对象的创建及其生命周期，提供依赖注入实现，是 DI 的具体实现
- DI 是一种设计模式，将依赖通过“注入”的方式提供给需要的类，是 DIP 和 IoC 的具体实现
- IoC 是一种设计原则（或设计模式），将代码本职之外的工作交由某个第三方（框架）完成，与 DIP 相似
- DIP 是一种设计原则，它认为高层组件的功能不应该依赖下层组件的实现，而应该提供抽象层让下层依赖，与 IoC 有异曲同工之妙

## 总结

依赖反转原则（DIP）

- 我们可以使用它来实现结构良好, 高度分离和可重用的软件组件
- 学会制定标准, 倒置依赖, 反转控制, 释放自身资源, 专注于更重要的事.
- 要让高层组件拥有定义抽象的权力，而不是把这个权力下放到低层组件。


DIP ≠ DI + IoC。