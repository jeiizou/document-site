# [基础]光源

WEBGL的光照方式有很多种, 最简单的是方向光源.

## 方向光源(平行光)

方向光源是指光照均匀的来自某一个方向, 比如直射的太阳光, 可以看做是平行光.

计算方向光是比较简单的, 将方向光的方向和面的朝向**点乘**就可以得到两个方向的余弦值.

将三维物体的朝向和光的方向点乘, 结果为1则物体朝向和光照方向相同, 为-1则物体朝向和光照方向相反.

这有什么用?

如果三维物体的朝向和光的方向点乘, 如果是1, 则说明物体朝向光照的方向相同, 如果为-1, 则说明物体和光照的方向相背.

那么我们将颜色值和点乘的结果相乘, 就产生了光.

那么, 我们如何知道三维物体的朝向 ?

## 法向量

法向量是一个好的办法. 

所谓的法向量是描述面的朝向的单位向量. 


平行光的案例可以参照`./code/光照:平行光`

## 点光源

点光源, 就是把原来的方向改为从三维空间中选择一个点作为光源, 然后在着色器中根据光源和表面位置计算光照方向. 

每个点都有一个不同的面到光源的矢量, 将这个矢量和法向量点乘以后, 表面上的每个点都会有一个不同的光照值. 

## 镜面高光

观察现实世界中的物体, 如果物体表面恰好将光线反射到你的眼前, 就是显得非常明亮.

我们可以通过计算光线反射到眼前来模拟情况, 具体的计算依然是通过点乘.

在点光源的计算中, 我们是知道物体表面到光源的方向的, 只要再知道物体表面到相机的方向, 再除以2就能得到中间向量`halfVector`.

当这个向量与到眼前的向量的点积为1, 则说明方向相同, 0表示垂直, -1表示相反. 

因此只要计算表面的相机的方向矢量, 然后传递到片元着色器中.

这部分的案例可以看到`./code/光照:点光源`

## 聚光灯

聚光灯相比点光源来说, 只是多了一点点的修改, 就是增加了一个光照的限定范围. 

实现聚光灯只需要以一个点光源作为起点, 然后选择一个方向和范围, 判断光线是否在限定的范围中, 如果不在, 就不选择照亮.

## GLSL中的 undefine

GLSL中的一些函数在某些情况下会出现`undiefined`. 比如对一个负值使用`pow`求幂就是一个例子. 因为结果是无法预知的.

